/**
* @license
*
* Regression.JS - Regression functions for javascript
* http://tom-alexander.github.com/regression-js/
*
* copyright(c) 2013 Tom Alexander
* Licensed under the MIT license.
*
* @module regression - Least-squares regression functions for JavaScript
**/
!function(b,c){"function"==typeof define&&define.amd?define("regression",c):"undefined"!=typeof module?module.exports=c():b.regression=c()}(this,function(){"use strict";function c(a,b){var c=a.reduce(function(a,b){return a+b[1]},0),d=c/a.length,e=a.reduce(function(a,b){var c=b[1]-d;return a+c*c},0);return 1-a.reduce(function(a,c,d){var e=b[d],f=c[1]-e[1];return a+f*f},0)/e}function d(a,b){var c=0,d=0,e=0,f=0,g=0,h=a.length-1,i=new Array(b);for(c=0;c<h;c++){for(f=c,d=c+1;d<h;d++)Math.abs(a[c][d])>Math.abs(a[c][f])&&(f=d);for(e=c;e<h+1;e++)g=a[e][c],a[e][c]=a[e][f],a[e][f]=g;for(d=c+1;d<h;d++)for(e=h;e>=c;e--)a[e][d]-=a[e][c]*a[c][d]/a[c][c]}for(d=h-1;d>=0;d--){for(g=0,e=d+1;e<h;e++)g+=a[e][d]*i[e];i[d]=(a[h][d]-g)/a[d][d]}return i}function f(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}var g={linear:function(a,b,d){for(var g,h,i,e=[0,0,0,0,0],j=a.length,k=0;k<j;k++)null!==a[k][1]&&(e[0]+=a[k][0],e[1]+=a[k][1],e[2]+=a[k][0]*a[k][0],e[3]+=a[k][0]*a[k][1],e[4]+=a[k][1]*a[k][1]);return h=(j*e[3]-e[0]*e[1])/(j*e[2]-e[0]*e[0]),i=e[1]/j-h*e[0]/j,g=a.map(function(a){var b=a[0];return[b,h*b+i]}),{r2:c(a,g),equation:[h,i],points:g,string:"y = "+f(h,d.precision)+"x + "+f(i,d.precision)}},linearthroughorigin:function(a,b,d){for(var g,h,e=[0,0],i=0;i<a.length;i++)null!==a[i][1]&&(e[0]+=a[i][0]*a[i][0],e[1]+=a[i][0]*a[i][1]);return g=e[1]/e[0],h=a.map(function(a){var b=a[0];return[b,g*b]}),{r2:c(a,h),equation:[g],points:h,string:"y = "+f(g,d.precision)+"x"}},exponential:function(a,b,d){for(var g,h,i,j,e=[0,0,0,0,0,0],k=0;k<a.length;k++)null!==a[k][1]&&(e[0]+=a[k][0],e[1]+=a[k][1],e[2]+=a[k][0]*a[k][0]*a[k][1],e[3]+=a[k][1]*Math.log(a[k][1]),e[4]+=a[k][0]*a[k][1]*Math.log(a[k][1]),e[5]+=a[k][0]*a[k][1]);return g=e[1]*e[2]-e[5]*e[5],h=Math.exp((e[2]*e[3]-e[5]*e[4])/g),i=(e[1]*e[4]-e[5]*e[3])/g,j=a.map(function(a){var b=a[0];return[b,h*Math.exp(i*b)]}),{r2:c(a,j),equation:[h,i],points:j,string:"y = "+f(h,d.precision)+"e^("+f(i,d.precision)+"x)"}},logarithmic:function(a,b,d){for(var g,h,i,e=[0,0,0,0],j=a.length,k=0;k<j;k++)null!==a[k][1]&&(e[0]+=Math.log(a[k][0]),e[1]+=a[k][1]*Math.log(a[k][0]),e[2]+=a[k][1],e[3]+=Math.pow(Math.log(a[k][0]),2));return h=(j*e[1]-e[2]*e[0])/(j*e[3]-e[0]*e[0]),g=(e[2]-h*e[0])/j,i=a.map(function(a){var b=a[0];return[b,g+h*Math.log(b)]}),{r2:c(a,i),equation:[g,h],points:i,string:"y = "+f(g,d.precision)+" + "+f(h,d.precision)+" ln(x)"}},power:function(a,b,d){for(var g,h,i,e=[0,0,0,0],j=a.length,k=0;k<j;k++)null!==a[k][1]&&(e[0]+=Math.log(a[k][0]),e[1]+=Math.log(a[k][1])*Math.log(a[k][0]),e[2]+=Math.log(a[k][1]),e[3]+=Math.pow(Math.log(a[k][0]),2));return h=(j*e[1]-e[2]*e[0])/(j*e[3]-e[0]*e[0]),g=Math.exp((e[2]-h*e[0])/j),i=a.map(function(a){var b=a[0];return[b,g*Math.pow(b,h)]}),{r2:c(a,i),equation:[g,h],points:i,string:"y = "+f(g,d.precision)+"x^"+f(h,d.precision)}},polynomial:function(a,b,e){var k,l,m,n,o,q,r,s,g=[],h=[],i=0,j=0,p=a.length;for(l=void 0===b?3:b+1,m=0;m<l;m++){for(o=0;o<p;o++)null!==a[o][1]&&(i+=Math.pow(a[o][0],m)*a[o][1]);for(g.push(i),i=0,k=[],n=0;n<l;n++){for(o=0;o<p;o++)null!==a[o][1]&&(j+=Math.pow(a[o][0],m+n));k.push(j),j=0}h.push(k)}for(h.push(g),r=d(h,l),q=a.map(function(a){var b=a[0],c=r.reduce(function(a,c,d){return a+c*Math.pow(b,d)},0);return[b,c]}),s="y = ",m=r.length-1;m>=0;m--)s+=m>1?f(r[m],e.precision)+"x^"+m+" + ":1===m?f(r[m],e.precision)+"x + ":f(r[m],e.precision);return{r2:c(a,q),equation:r,points:q,string:s}},lastvalue:function(a,b,d){for(var e=[],g=null,h=0;h<a.length;h++)null!==a[h][1]&&isFinite(a[h][1])?(g=a[h][1],e.push([a[h][0],a[h][1]])):e.push([a[h][0],g]);return{r2:c(a,e),equation:[g],points:e,string:""+f(g,d.precision)}}};return function(b,c,d,f){var h="object"==typeof d&&void 0===f?d:f||{};return h.precision||(h.precision=2),"string"==typeof b?g[b.toLowerCase()](c,d,h):null}});